# Домашнее задание к занятию «3.1. Теоретические основы криптографии, симметричные криптосистемы»

В качестве результата пришлите ответы на вопросы в личном кабинете студента на сайте [netology.ru](https://netology.ru).

## Общие замечания по безопасности

При скачивании любых файлов перед их открытием рекомендуем вам проверять их с помощью сервиса [VirusTotal](https://www.virustotal.com/gui/home/upload).

## Общие замечания по выполнению ДЗ

Если у вас что-то не получилось, то пишите в канал курса, обязательно указывая:
1. Номер ДЗ
1. ОС
1. На каком шаге остановились
1. Скриншот ошибки
1. Краткое описание того, что сделали

Пожалуйста, не пишите сообщения в стиле `я всё сделал по инструкции, ничего не работает` - это никоим образом не поможет решить проблему.

## Работа в терминале

Ознакомьтесь с [руководством по работе в терминале](../terminal) для вашей операционной системы.

## Задача №1 - HashCat

### Справка

[hashcat](https://hashcat.net/hashcat/) - инструмент восстановления паролей.

### Установка

Для установки достаточно скачать архив с официального сайта:

![](pic/hashcat.png)

<details>
<summary>Для счастливых обладателей Mac</summary>

Если вам повезло и вы пользователь Mac, то для вас готового hashcat в указанном архиве на официальном сайте нет, поэтому вам будет необходимо установить [Homebrew](https://brew.sh). Для этого небоходимо перейти по адресу https://brew.sh выполнить указанную на главной странице команду в терминале:

![](pic/brew.png)

После чего в терминале (в любом каталоге) выполнить команду:

```shell script
brew install hashcat
```

Индикатором успешности установки будет служить успешное выполнение следующей команды:

```shell script
hashcat --help
```

</details>

Архив упакован с помощью архиватора [7zip](https://www.7-zip.org/download.html), поэтому, возможно, вам придётся установить и его.

Распакуйте архив в каталог на вашем компьютере и откройте терминал каталоге, в котором расположены файлы `hashcat.bin` и `hashcat.exe` (см. [руководство по терминалу](../terminal)).

Для Linux необходимо запускать в терминале hashcat командой `./hashcat.bin` (находясь в том же каталоге), в Windows командой `.\hashcat.exe` (находясь в том же каталоге), а в Mac просто `hashcat` (при этом никакой архив с hashcat вам не нужен).

Далее для простоты мы будем просто писать `hashcat`, а не `./hashcat.bin` или `.\hashcat.exe`.

### Справка

Справка по работе с приложением выводится с помощью флага `--help`:
```shell script
hashcat --help
```

В общем виде hashcat запускается в следующем виде:
```shell script
hashcat [options] hash [dictionary]
```

### Задание

Каким-то образом у вас оказался хэш пароля. Вот такой: `5693299e0bbe87f327caa802008af432fbe837976b1232f8982d3e101b5b6fab`.

Что нужно сделать: вам нужно попробовать по длине хэша угадать его тип (это будет один из тех, что упоминался на лекции, как минимум, в табличке в конце лекции).
```bash
hashcat -m 6900  -a 0   5693299e0bbe87f327caa802008af432fbe837976b1232f8982d3e101b5b6fab xato-net-10-million-passwords.txt
```
```cmd
.\cracker-x64.exe 6900 5693299e0bbe87f327caa802008af432fbe837976b1232f8982d3e101b5b6fab  xato-net-10-million-passwords.txt
```

<details>
<summary>Подсказка</summary>
  
Обратите внимание, мы не просто так говорим про длину.
</details>

<details>
<summary>Использование hashcat</summary>

Запустить hashcat для подбора пароля можно в следующем формате:

`hashcat -m <X> 5693299e0bbe87f327caa802008af432fbe837976b1232f8982d3e101b5b6fab wordlist.txt`

Где `<X>` это тип хэша, в соответствии с таблицей (т.е. для GOST R 34.11-2012 (Streebog) 256-bit, big-endian будет `11700`):

|     # | Name                                             | Category                            |
|-------|--------------------------------------------------|-------------------------------------|
|   900 | MD4                                              | Raw Hash                            |
|     0 | MD5                                              | Raw Hash                            |
|   100 | SHA1                                             | Raw Hash                            |
|  1300 | SHA2-224                                         | Raw Hash                            |
|  1400 | SHA2-256                                         | Raw Hash                            |
| 10800 | SHA2-384                                         | Raw Hash                            |
|  1700 | SHA2-512                                         | Raw Hash                            |
| 11700 | GOST R 34.11-2012 (Streebog) 256-bit, big-endian | Raw Hash                            |
| 11800 | GOST R 34.11-2012 (Streebog) 512-bit, big-endian | Raw Hash                            |
|  6900 | GOST R 34.11-94                                  | Raw Hash                            |

А `wordlist.txt` - файл с самыми распространёнными паролями. Набор таких файлов вы можете найти по адресу https://github.com/danielmiessler/SecLists/tree/master/Passwords/Common-Credentials.

Т.е. мы собираемся осуществить атаку по словарю.

Мы рекомендуем вам использовать [`Common-Credentials/10-million-password-list-top-100000.txt`](https://raw.githubusercontent.com/danielmiessler/SecLists/master/Passwords/Common-Credentials/10-million-password-list-top-100000.txt).
<details>

<summary>Проблемы с hashcat?</summary>

Для этого случая мы сделали для вас небольшую утилиту, которая также умеет "взламывать" пароли.

Поддерживает она только те, что требуются в рамках данного ДЗ и располагается в каталоге assets:
* [Windows x32](assets/cracker-x32.exe)
* [Windows x64](assets/cracker-x64.exe)
* [Linux x32](assets/cracker-x32.bin)
* [Linux x64](assets/cracker-x64.bin)
* [Mac OS](assets/icracker-x64.bin)

Как запускать:
1. Скачиваете исполняемый файл, а также словарь в один каталог, открываете в этом каталоге терминал
1. Проверяете исполняемый файл на [VirusTotal](https://www.virustotal.com)
1. В терминале запускаете `cracker <тип хэша> <хэш> <имя файла словаря>`:
    1. Для Win32 CMD: .\cracker-x32.exe 0 5f4dcc3b5aa765d61d8327deb882cf99 million.txt
    1. Для Win64 CMD: .\cracker-x64.exe 0 5f4dcc3b5aa765d61d8327deb882cf99 million.txt
    1. Для Win32 PowerShell: .\cracker-x32.exe 0 5f4dcc3b5aa765d61d8327deb882cf99 million.txt
    1. Для Win64 PowerShell: .\cracker-x64.exe 0 5f4dcc3b5aa765d61d8327deb882cf99 million.txt
    1. Для Linux32: chmod +x ./cracker-x32.bin && ./cracker-x32.bin 0 5f4dcc3b5aa765d61d8327deb882cf99 million.txt
    1. Для Linux64: chmod +x ./cracker-x64.bin && ./cracker-x64.bin 0 5f4dcc3b5aa765d61d8327deb882cf99 million.txt
    1. Для MacOS: chmod +x ./icracker-x64.bin && ./icracker-x64.bin 0 5f4dcc3b5aa765d61d8327deb882cf99 million.txt
1. Ждёте результата работы программы:
    * `Cracked: password` (хэш "взломан", `password` - то, что вам нужно)
    * `Not cracked` (хэш не "взломан", вы выбрали неверный алгоритм хэширования, ошиблись в написании хэша или файл словаря не содержит нужного слова)
</details>
</details>

В качестве ответа пришлите название функции хэширования и "угаданный" пароль.
![](1.jpg)
## Задача №2 - VeraCrypt

### Справка 

[VeraCrypt](https://www.veracrypt.fr/en/Home.html) - Open Source ПО для шифрования дисков.

Позволяет делать достаточно много вещей, но нас будет интересовать одна ключевая функция: возможность создать виртуальный зашифрованный диск и "подключать" к вашей ОС, при этом все операции чтения/записи с этого диска будут происходить прозрачно для пользователя.

[Скачать VeraCrypt](https://www.veracrypt.fr/en/Downloads.html) можно с официальной страницы (не качайте из неизвестных источников).

![](pic/veracrypt.png)

### Установка

#### Windows

Для пользователей Windows необходимо скачать файл, соответствующий вашей версии ОС и запустить установку:

![](pic/win-install-01.png)

Далее необходимо следовать указаниям мастера установки, оставляя выбранными значения по умолчанию.

#### Linux

Для пользователей Linux (Ubuntu) необходимо скачать файл с расширением deb (GUI-версия), затем открыть терминал в каталоге, в который вы скачали файл и выполнить команду: `sudo apt install ./<имя файла>.deb`

#### Mac OS

Для пользователей Mac необходимо скачать [OSXFUSE](https://github.com/osxfuse/osxfuse/releases) и установочный файл VeraCrypt.

<details>
<summary>Описание процесса установки</summary>

Перед началом установки перейдите в системные настройки:

![](pic/mac-settings.png)

Выберите Защита и безопасность, нажмите на иконку замка (1) и установите переключатель (2) как на скриншоте:

![](pic/mac-install-00.png)

Первым необходимо установить OSXFUSE. Затем VeraCrypt.

##### Шаг 1: Кликните два раза на иконку установки:

![](pic/mac-install-01.png)

##### Шаг 2: Нажмите Продолжить:

![](pic/mac-install-02.png)

##### Шаг 3: Пройдите по шагам установщика с помощью кнопки Продолжить до пункта Тип установки:

![](pic/mac-install-03.png)

##### Шаг 4. Убедитесь, что в пункте Тип установки у вас установлены флажки как на скриншоте и продолжите установку:

![](pic/mac-install-04.png)

##### Шаг 5. При блокировке системного расширения нажмите кнопку Открыть настройки безопасности:

![](pic/mac-install-05.png)

##### Шаг 6: Нажмите на иконку замка (1), после чего на кнопку Разрешить (2):

![](pic/mac-install-06.png)

##### Шаг 7: Дождитесь завершения установки и перезагрузите компьютер:

![](pic/mac-install-07.png)

##### Шаг 8: Запустите на установку VeraCrypt

![](pic/mac-install-08.png)

##### Шаг 9: Пройдите по шагам мастера установки, оставляя выбранными все значения по умолчанию:

![](pic/mac-install-09.png)

</details>

### Инструкция 

#### Windows

<details>
<summary>Описание работы с VeraCrypt</summary>

##### Шаг 1. Запустите исполняемый файл VeraCrypt-x64:

![](pic/win-01.png)

##### Шаг 2. Нажмите на кнопку Create Volume:

![](pic/win-02.png)

##### Шаг 3. Оставьте выбранной опцию Create an encrypted file container (1) и нажмите Next (2):

![](pic/win-03.png)

**Важно**: убедитесь, что вы выбрали именно эту опцию, а не другие (поскольку вы можете зашифровать целый раздел своего диска или системный диск).

##### Шаг 4. Оставьте выбранной опцию Standard VeraCrypt volume (1) и нажмите Next (2):

![](pic/win-04.png)

##### Шаг 5. Нажмите Select File для создания файла-контейнера

![](pic/win-05.png)

##### Шаг 6. Выберите файл-контейнер

![](pic/win-06.png)

Мы выбрали каталог C:\projects, а затем вручную в поле имя файла ввели имя container.

**Важно**: не выбирайте существующие файлы с данными! VeraCrypt перетрёт данные (не зашифрует, а именно перетрёт).

##### Шаг 7. Нажмите Next

![](pic/win-07.png)

##### Шаг 8. Оставьте опции по умолчанию: AES (1) и SHA-512 (2) и нажмите кнопку Next (3):

![](pic/win-08.png)

##### Шаг 9. Установите размер контейнера равным 5 MB (1) и нажмите на кнопку Next (2):

![](pic/win-09.png)

##### Шаг 10. Введите пароль (1) и его подтверждение (2) и нажмите на кнопку Next (3):

![](pic/win-10.png)

Используйте сложный пароль: как минимум 20 символов (не забудьте его сохранить).

Обратите внимание: VeraCrypt предупредит вас при попытке использовать простой пароль:

![](pic/win-10.1.png)

##### Шаг 11. Перемещайте указатель мыши внутри окна пока индикатор Randomness (1) не станет зелёным, после чего нажмите на кнопку Format (2):

![](pic/win-11.png)

##### Шаг 12. Завершите создание контейнера, нажав на кнопку Ok:

![](pic/win-12.png)

##### Шаг 13. Вернитесь в основное окно программы, выберите незанятую букву диска (1), например, V:, выберите файл-контейнера (2) и нажмите на кнопку Mount (3):

![](pic/win-13.png)

##### Шаг 14. Введите пароль (1) для контейнера (надеемся вы его не забыли) нажмите на кнопку ОК (2):

![](pic/win-14.png)

##### Шаг 15. Убедитесь, что диск примонтировался

![](pic/win-15.png)

##### Шаг 16. Создайте на диске текстовый файл, содержащий вашу фамилию: 

![](pic/win-16.png)

##### Шаг 17. Размонтируйте диск с помощью кнопки Dismount:

![](pic/win-17.png)

##### Шаг 18. Повторите процедуру монтирования, чтобы убедиться, что сохранённые вами данные читаются

</details>

#### Linux

Для Linux процедура полностью аналогична за исключением ряда отличий.

<details>
<summary>Описание отличий по работе с VeraCrypt</summary>

В основном окне у вас будут показываться не диски, а Slot'ы:

![](pic/linux-01.png)

А каталог, в которой примонтируется контейнер будет отображаться в столбце Mount Directory:

![](pic/linux-02.png)

</details>

#### Mac

Для Mac процедура полностью аналогична за исключением ряда отличий.

<details>
<summary>Описание отличий по работе с VeraCrypt</summary>

В основном окне у вас будут показываться не диски, а Slot'ы:

![](pic/mac-01.png)

А каталог, в которой примонтируется контейнер будет отображаться в столбце Mount Directory:

![](pic/mac-02.png)

</details>

### Результаты

Отправьте контейнер и пароль к нему в ЛК пользователя:

![](pic/veracrypt-solution.png)
